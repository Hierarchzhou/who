{"ast":null,"code":"import { ref, watch } from 'vue';\nimport { getFallbackAvatarUrl } from '../../utils/avatarUtils';\nimport AvatarPicker from './AvatarPicker.vue';\nimport { useStore } from 'vuex';\nexport default {\n  name: 'UserProfileEditor',\n  components: {\n    AvatarPicker\n  },\n  props: {\n    isOpen: Boolean\n  },\n  setup(props, {\n    emit\n  }) {\n    const store = useStore();\n\n    // 从store获取用户信息\n    const username = ref(store.getters['userProfile/username'] || '');\n    const currentAvatar = ref(store.getters['userProfile/avatar'] || '');\n    const currentStatus = ref(store.getters['userProfile/status'] || 'online');\n    const bio = ref(store.getters['userProfile/bio'] || '');\n    const showAvatarPicker = ref(false);\n    const statusOptions = {\n      online: '在线',\n      away: '离开',\n      busy: '请勿打扰',\n      invisible: '隐身'\n    };\n\n    // 监听store中的用户信息变化\n    watch(() => store.getters['userProfile/profile'], newValue => {\n      username.value = newValue.username || '';\n      currentAvatar.value = newValue.avatar || '';\n      currentStatus.value = newValue.status || 'online';\n      bio.value = newValue.bio || '';\n    }, {\n      deep: true\n    });\n    const openAvatarPicker = () => showAvatarPicker.value = true;\n    const closeAvatarPicker = () => showAvatarPicker.value = false;\n    const handleAvatarSelected = avatar => currentAvatar.value = avatar;\n    const selectStatus = status => currentStatus.value = status;\n    const saveProfile = () => {\n      const updatedProfile = {\n        username: username.value,\n        avatar: currentAvatar.value,\n        status: currentStatus.value,\n        bio: bio.value\n      };\n\n      // 更新store中的用户信息\n      store.dispatch('userProfile/updateProfile', updatedProfile);\n      emit('update-profile', updatedProfile);\n      emit('close');\n    };\n    return {\n      username,\n      currentAvatar,\n      currentStatus,\n      bio,\n      statusOptions,\n      showAvatarPicker,\n      selectStatus,\n      saveProfile,\n      closeEditor: () => emit('close'),\n      openAvatarPicker,\n      closeAvatarPicker,\n      handleAvatarSelected,\n      getFallbackAvatarUrl\n    };\n  }\n};","map":{"version":3,"names":["ref","watch","getFallbackAvatarUrl","AvatarPicker","useStore","name","components","props","isOpen","Boolean","setup","emit","store","username","getters","currentAvatar","currentStatus","bio","showAvatarPicker","statusOptions","online","away","busy","invisible","newValue","value","avatar","status","deep","openAvatarPicker","closeAvatarPicker","handleAvatarSelected","selectStatus","saveProfile","updatedProfile","dispatch","closeEditor"],"sources":["C:\\Users\\Administrator\\Desktop\\who\\src\\components\\chat\\UserProfileEditor.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-editor-overlay\" v-if=\"isOpen\" @click.self=\"closeEditor\">\r\n    <div class=\"profile-editor-container\">\r\n      <!-- 头部 -->\r\n      <div class=\"profile-editor-header\">\r\n        <h2>个人资料</h2>\r\n        <button class=\"close-button\" @click=\"closeEditor\">\r\n          <span class=\"close-icon\">×</span>\r\n        </button>\r\n      </div>\r\n      \r\n      <!-- 主要内容区域 -->\r\n      <div class=\"profile-editor-content\">\r\n        <!-- 头像编辑区域 -->\r\n        <div class=\"avatar-section\">\r\n          <div class=\"current-avatar-wrapper\" @click=\"openAvatarPicker\">\r\n            <img :src=\"currentAvatar\" alt=\"用户头像\" class=\"current-avatar\" />\r\n            <div class=\"avatar-overlay\">\r\n              <span class=\"change-text\">更换头像</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 用户信息编辑区域 -->\r\n        <div class=\"user-info-section\">\r\n          <div class=\"form-group\">\r\n            <label for=\"username\">\r\n              用户名\r\n            </label>\r\n            <input \r\n              type=\"text\" \r\n              id=\"username\" \r\n              v-model=\"username\" \r\n              placeholder=\"设置你的用户名\"\r\n              class=\"form-input\"\r\n            />\r\n          </div>\r\n          \r\n          <div class=\"form-group\">\r\n            <label for=\"status\">\r\n              状态\r\n            </label>\r\n            <div class=\"status-selector\">\r\n              <button \r\n                v-for=\"(status, key) in statusOptions\" \r\n                :key=\"key\"\r\n                class=\"status-option\"\r\n                :class=\"{ active: currentStatus === key }\"\r\n                @click=\"selectStatus(key)\"\r\n              >\r\n                <span class=\"status-icon\" :class=\"key\"></span>\r\n                <span class=\"status-text\">{{ status }}</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"form-group\">\r\n            <label for=\"bio\">\r\n              个人简介\r\n            </label>\r\n            <textarea \r\n              id=\"bio\" \r\n              v-model=\"bio\" \r\n              placeholder=\"介绍一下自己吧...\"\r\n              class=\"form-input bio-input\"\r\n              rows=\"3\"\r\n            ></textarea>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- 底部按钮 -->\r\n      <div class=\"profile-editor-footer\">\r\n        <button class=\"cancel-button\" @click=\"closeEditor\">\r\n          取消\r\n        </button>\r\n        <button class=\"save-button\" @click=\"saveProfile\">\r\n          确认更改\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 头像选择器 -->\r\n    <AvatarPicker\r\n      v-if=\"showAvatarPicker\"\r\n      :currentAvatar=\"currentAvatar\"\r\n      @close=\"closeAvatarPicker\"\r\n      @select=\"handleAvatarSelected\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, watch } from 'vue';\r\nimport { getFallbackAvatarUrl } from '../../utils/avatarUtils';\r\nimport AvatarPicker from './AvatarPicker.vue';\r\nimport { useStore } from 'vuex';\r\n\r\nexport default {\r\n  name: 'UserProfileEditor',\r\n  components: { AvatarPicker },\r\n  props: {\r\n    isOpen: Boolean\r\n  },\r\n  setup(props, { emit }) {\r\n    const store = useStore();\r\n    \r\n    // 从store获取用户信息\r\n    const username = ref(store.getters['userProfile/username'] || '');\r\n    const currentAvatar = ref(store.getters['userProfile/avatar'] || '');\r\n    const currentStatus = ref(store.getters['userProfile/status'] || 'online');\r\n    const bio = ref(store.getters['userProfile/bio'] || '');\r\n    const showAvatarPicker = ref(false);\r\n    \r\n    const statusOptions = {\r\n      online: '在线',\r\n      away: '离开',\r\n      busy: '请勿打扰',\r\n      invisible: '隐身'\r\n    };\r\n\r\n    // 监听store中的用户信息变化\r\n    watch(() => store.getters['userProfile/profile'], (newValue) => {\r\n      username.value = newValue.username || '';\r\n      currentAvatar.value = newValue.avatar || '';\r\n      currentStatus.value = newValue.status || 'online';\r\n      bio.value = newValue.bio || '';\r\n    }, { deep: true });\r\n\r\n    const openAvatarPicker = () => showAvatarPicker.value = true;\r\n    const closeAvatarPicker = () => showAvatarPicker.value = false;\r\n    const handleAvatarSelected = (avatar) => currentAvatar.value = avatar;\r\n    const selectStatus = (status) => currentStatus.value = status;\r\n\r\n    const saveProfile = () => {\r\n      const updatedProfile = {\r\n        username: username.value,\r\n        avatar: currentAvatar.value,\r\n        status: currentStatus.value,\r\n        bio: bio.value\r\n      };\r\n      \r\n      // 更新store中的用户信息\r\n      store.dispatch('userProfile/updateProfile', updatedProfile);\r\n      emit('update-profile', updatedProfile);\r\n      emit('close');\r\n    };\r\n\r\n    return {\r\n      username,\r\n      currentAvatar,\r\n      currentStatus,\r\n      bio,\r\n      statusOptions,\r\n      showAvatarPicker,\r\n      selectStatus,\r\n      saveProfile,\r\n      closeEditor: () => emit('close'),\r\n      openAvatarPicker,\r\n      closeAvatarPicker,\r\n      handleAvatarSelected,\r\n      getFallbackAvatarUrl\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile-editor-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n  backdrop-filter: blur(8px);\r\n}\r\n\r\n.profile-editor-container {\r\n  width: 90%;\r\n  max-width: 480px;\r\n  background: var(--chat-background);\r\n  border-radius: 16px;\r\n  overflow: hidden;\r\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\r\n  animation: slideIn 0.3s ease;\r\n}\r\n\r\n@keyframes slideIn {\r\n  from { transform: translateY(20px); opacity: 0; }\r\n  to { transform: translateY(0); opacity: 1; }\r\n}\r\n\r\n.profile-editor-header {\r\n  padding: 20px;\r\n  background: linear-gradient(to right, var(--primary-color), var(--secondary-color));\r\n  color: white;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.profile-editor-header h2 {\r\n  margin: 0;\r\n  font-size: 1.5rem;\r\n  font-weight: 600;\r\n}\r\n\r\n.close-button {\r\n  background: none;\r\n  border: none;\r\n  color: white;\r\n  font-size: 24px;\r\n  cursor: pointer;\r\n  width: 32px;\r\n  height: 32px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 50%;\r\n  transition: background-color 0.2s;\r\n}\r\n\r\n.close-button:hover { background-color: rgba(255, 255, 255, 0.2); }\r\n\r\n.profile-editor-content { padding: 24px; }\r\n\r\n.avatar-section {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-bottom: 32px;\r\n}\r\n\r\n.current-avatar-wrapper {\r\n  position: relative;\r\n  width: 120px;\r\n  height: 120px;\r\n  border-radius: 50%;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n  background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));\r\n  padding: 3px;\r\n}\r\n\r\n.current-avatar {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n  border-radius: 50%;\r\n  background: var(--chat-background);\r\n}\r\n\r\n.avatar-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  opacity: 0;\r\n  transition: opacity 0.3s ease;\r\n}\r\n\r\n.current-avatar-wrapper:hover .avatar-overlay { opacity: 1; }\r\n\r\n.change-text {\r\n  color: white;\r\n  font-size: 14px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.form-group label {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin-bottom: 8px;\r\n  color: var(--text-color);\r\n  font-weight: 500;\r\n}\r\n\r\n.form-group .material-icons {\r\n  font-size: 20px;\r\n  color: var(--primary-color);\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background: var(--input-background);\r\n  border: 1px solid var(--border-color);\r\n  border-radius: 8px;\r\n  color: var(--text-color);\r\n  font-size: 14px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.form-input:focus {\r\n  outline: none;\r\n  border-color: var(--primary-color);\r\n  box-shadow: 0 0 0 2px rgba(var(--primary-color-rgb), 0.2);\r\n}\r\n\r\n.bio-input {\r\n  resize: vertical;\r\n  min-height: 80px;\r\n}\r\n\r\n.status-selector {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));\r\n  gap: 8px;\r\n}\r\n\r\n.status-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 8px 12px;\r\n  background: var(--input-background);\r\n  border: 1px solid var(--border-color);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.status-option:hover { background: var(--hover-color); }\r\n\r\n.status-option.active {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  border-color: var(--primary-color);\r\n}\r\n\r\n.status-icon {\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 50%;\r\n}\r\n\r\n.status-icon.online { background-color: #43b581; }\r\n.status-icon.away { background-color: #faa61a; }\r\n.status-icon.busy { background-color: #f04747; }\r\n.status-icon.invisible { background-color: #747f8d; }\r\n\r\n.profile-editor-footer {\r\n  padding: 16px 20px;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 12px;\r\n  background: var(--input-background);\r\n  border-top: 1px solid var(--border-color);\r\n}\r\n\r\n.cancel-button, .save-button {\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.cancel-button {\r\n  background: transparent;\r\n  border: 1px solid var(--border-color);\r\n  color: var(--text-color);\r\n}\r\n\r\n.cancel-button:hover { background: var(--hover-color); }\r\n\r\n.save-button {\r\n  background: var(--primary-color);\r\n  border: none;\r\n  color: white;\r\n}\r\n\r\n.save-button:hover {\r\n  background: var(--secondary-color);\r\n  transform: translateY(-1px);\r\n}\r\n\r\n.material-icons {\r\n  font-size: 18px;\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .profile-editor-container {\r\n    width: 100%;\r\n    height: 100%;\r\n    border-radius: 0;\r\n  }\r\n}\r\n</style> "],"mappings":"AA6FA,SAASA,GAAG,EAAEC,KAAI,QAAS,KAAK;AAChC,SAASC,oBAAmB,QAAS,yBAAyB;AAC9D,OAAOC,YAAW,MAAO,oBAAoB;AAC7C,SAASC,QAAO,QAAS,MAAM;AAE/B,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,UAAU,EAAE;IAAEH;EAAa,CAAC;EAC5BI,KAAK,EAAE;IACLC,MAAM,EAAEC;EACV,CAAC;EACDC,KAAKA,CAACH,KAAK,EAAE;IAAEI;EAAK,CAAC,EAAE;IACrB,MAAMC,KAAI,GAAIR,QAAQ,CAAC,CAAC;;IAExB;IACA,MAAMS,QAAO,GAAIb,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,sBAAsB,KAAK,EAAE,CAAC;IACjE,MAAMC,aAAY,GAAIf,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,oBAAoB,KAAK,EAAE,CAAC;IACpE,MAAME,aAAY,GAAIhB,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,oBAAoB,KAAK,QAAQ,CAAC;IAC1E,MAAMG,GAAE,GAAIjB,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,iBAAiB,KAAK,EAAE,CAAC;IACvD,MAAMI,gBAAe,GAAIlB,GAAG,CAAC,KAAK,CAAC;IAEnC,MAAMmB,aAAY,GAAI;MACpBC,MAAM,EAAE,IAAI;MACZC,IAAI,EAAE,IAAI;MACVC,IAAI,EAAE,MAAM;MACZC,SAAS,EAAE;IACb,CAAC;;IAED;IACAtB,KAAK,CAAC,MAAMW,KAAK,CAACE,OAAO,CAAC,qBAAqB,CAAC,EAAGU,QAAQ,IAAK;MAC9DX,QAAQ,CAACY,KAAI,GAAID,QAAQ,CAACX,QAAO,IAAK,EAAE;MACxCE,aAAa,CAACU,KAAI,GAAID,QAAQ,CAACE,MAAK,IAAK,EAAE;MAC3CV,aAAa,CAACS,KAAI,GAAID,QAAQ,CAACG,MAAK,IAAK,QAAQ;MACjDV,GAAG,CAACQ,KAAI,GAAID,QAAQ,CAACP,GAAE,IAAK,EAAE;IAChC,CAAC,EAAE;MAAEW,IAAI,EAAE;IAAK,CAAC,CAAC;IAElB,MAAMC,gBAAe,GAAIA,CAAA,KAAMX,gBAAgB,CAACO,KAAI,GAAI,IAAI;IAC5D,MAAMK,iBAAgB,GAAIA,CAAA,KAAMZ,gBAAgB,CAACO,KAAI,GAAI,KAAK;IAC9D,MAAMM,oBAAmB,GAAKL,MAAM,IAAKX,aAAa,CAACU,KAAI,GAAIC,MAAM;IACrE,MAAMM,YAAW,GAAKL,MAAM,IAAKX,aAAa,CAACS,KAAI,GAAIE,MAAM;IAE7D,MAAMM,WAAU,GAAIA,CAAA,KAAM;MACxB,MAAMC,cAAa,GAAI;QACrBrB,QAAQ,EAAEA,QAAQ,CAACY,KAAK;QACxBC,MAAM,EAAEX,aAAa,CAACU,KAAK;QAC3BE,MAAM,EAAEX,aAAa,CAACS,KAAK;QAC3BR,GAAG,EAAEA,GAAG,CAACQ;MACX,CAAC;;MAED;MACAb,KAAK,CAACuB,QAAQ,CAAC,2BAA2B,EAAED,cAAc,CAAC;MAC3DvB,IAAI,CAAC,gBAAgB,EAAEuB,cAAc,CAAC;MACtCvB,IAAI,CAAC,OAAO,CAAC;IACf,CAAC;IAED,OAAO;MACLE,QAAQ;MACRE,aAAa;MACbC,aAAa;MACbC,GAAG;MACHE,aAAa;MACbD,gBAAgB;MAChBc,YAAY;MACZC,WAAW;MACXG,WAAW,EAAEA,CAAA,KAAMzB,IAAI,CAAC,OAAO,CAAC;MAChCkB,gBAAgB;MAChBC,iBAAiB;MACjBC,oBAAoB;MACpB7B;IACF,CAAC;EACH;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}