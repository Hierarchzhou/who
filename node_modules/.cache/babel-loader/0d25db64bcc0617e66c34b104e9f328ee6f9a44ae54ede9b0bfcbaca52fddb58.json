{"ast":null,"code":"import { ref, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { getFallbackAvatarUrl, handleAvatarError } from '../../utils/avatarUtils';\nexport default {\n  name: 'UserProfileEditor',\n  props: {\n    isOpen: Boolean,\n    currentUserInfo: {\n      type: Object,\n      default: () => ({\n        username: '',\n        avatar: '',\n        bio: ''\n      })\n    }\n  },\n  setup(props, {\n    emit\n  }) {\n    const store = useStore();\n    const username = ref(props.currentUserInfo.username);\n    const currentAvatar = ref(props.currentUserInfo.avatar);\n    const bio = ref(props.currentUserInfo.bio);\n\n    // 从 store 获取状态相关数据\n    const currentStatus = computed(() => store.getters['userStatus/currentStatus']);\n    const statusOptions = computed(() => store.state.userStatus.statusMap);\n\n    // 设置用户状态\n    const setStatus = async status => {\n      await store.dispatch('userStatus/setStatus', status);\n    };\n\n    // 打开头像选择器\n    const openAvatarPicker = () => {\n      const input = document.createElement('input');\n      input.type = 'file';\n      input.accept = 'image/*';\n      input.onchange = e => {\n        const file = e.target.files[0];\n        if (file) {\n          const reader = new FileReader();\n          reader.onload = e => {\n            currentAvatar.value = e.target.result;\n          };\n          reader.readAsDataURL(file);\n        }\n      };\n      input.click();\n    };\n\n    // 保存个人资料\n    const saveProfile = () => {\n      emit('update-profile', {\n        username: username.value,\n        avatar: currentAvatar.value,\n        bio: bio.value,\n        status: currentStatus.value\n      });\n      emit('close');\n    };\n    return {\n      username,\n      currentAvatar,\n      bio,\n      currentStatus,\n      statusOptions,\n      setStatus,\n      saveProfile,\n      openAvatarPicker,\n      getFallbackAvatarUrl,\n      handleAvatarError\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","useStore","getFallbackAvatarUrl","handleAvatarError","name","props","isOpen","Boolean","currentUserInfo","type","Object","default","username","avatar","bio","setup","emit","store","currentAvatar","currentStatus","getters","statusOptions","state","userStatus","statusMap","setStatus","status","dispatch","openAvatarPicker","input","document","createElement","accept","onchange","e","file","target","files","reader","FileReader","onload","value","result","readAsDataURL","click","saveProfile"],"sources":["C:\\Users\\Administrator\\Desktop\\discord-chat-app\\fack\\just-do-it\\src\\components\\profile\\UserProfileEditor.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-editor-overlay\" v-if=\"isOpen\">\r\n    <div class=\"profile-editor\">\r\n      <div class=\"profile-header\">\r\n        <h2>个人资料</h2>\r\n        <button class=\"close-btn\" @click=\"$emit('close')\">&times;</button>\r\n      </div>\r\n\r\n      <div class=\"profile-content\">\r\n        <!-- 头像部分 -->\r\n        <div class=\"avatar-section\">\r\n          <img :src=\"currentAvatar || getFallbackAvatarUrl()\" \r\n               alt=\"用户头像\" \r\n               class=\"profile-avatar\"\r\n               @error=\"handleAvatarError\" />\r\n          <div class=\"avatar-overlay\" @click=\"openAvatarPicker\">\r\n            <span class=\"change-text\">更换头像</span>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 用户名部分 -->\r\n        <div class=\"form-group\">\r\n          <label>用户名</label>\r\n          <input type=\"text\" \r\n                 v-model=\"username\" \r\n                 class=\"form-input\"\r\n                 placeholder=\"输入用户名\" />\r\n        </div>\r\n\r\n        <!-- 状态选择部分 -->\r\n        <div class=\"form-group\">\r\n          <label>状态</label>\r\n          <div class=\"status-options\">\r\n            <button \r\n              v-for=\"(text, status) in statusOptions\" \r\n              :key=\"status\"\r\n              class=\"status-btn\"\r\n              :class=\"{ active: status === currentStatus }\"\r\n              @click=\"setStatus(status)\"\r\n            >\r\n              <span class=\"status-dot\" :class=\"status\"></span>\r\n              <span class=\"status-text\">{{ text }}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 个人简介部分 -->\r\n        <div class=\"form-group\">\r\n          <label>个人简介</label>\r\n          <textarea \r\n            v-model=\"bio\" \r\n            class=\"form-input bio-input\"\r\n            placeholder=\"介绍一下自己吧...\"\r\n          ></textarea>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"profile-footer\">\r\n        <button class=\"cancel-btn\" @click=\"$emit('close')\">取消</button>\r\n        <button class=\"save-btn\" @click=\"saveProfile\">确认更改</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { getFallbackAvatarUrl, handleAvatarError } from '../../utils/avatarUtils'\r\n\r\nexport default {\r\n  name: 'UserProfileEditor',\r\n  props: {\r\n    isOpen: Boolean,\r\n    currentUserInfo: {\r\n      type: Object,\r\n      default: () => ({\r\n        username: '',\r\n        avatar: '',\r\n        bio: ''\r\n      })\r\n    }\r\n  },\r\n\r\n  setup(props, { emit }) {\r\n    const store = useStore()\r\n    const username = ref(props.currentUserInfo.username)\r\n    const currentAvatar = ref(props.currentUserInfo.avatar)\r\n    const bio = ref(props.currentUserInfo.bio)\r\n\r\n    // 从 store 获取状态相关数据\r\n    const currentStatus = computed(() => store.getters['userStatus/currentStatus'])\r\n    const statusOptions = computed(() => store.state.userStatus.statusMap)\r\n\r\n    // 设置用户状态\r\n    const setStatus = async (status) => {\r\n      await store.dispatch('userStatus/setStatus', status)\r\n    }\r\n\r\n    // 打开头像选择器\r\n    const openAvatarPicker = () => {\r\n      const input = document.createElement('input')\r\n      input.type = 'file'\r\n      input.accept = 'image/*'\r\n      input.onchange = (e) => {\r\n        const file = e.target.files[0]\r\n        if (file) {\r\n          const reader = new FileReader()\r\n          reader.onload = (e) => {\r\n            currentAvatar.value = e.target.result\r\n          }\r\n          reader.readAsDataURL(file)\r\n        }\r\n      }\r\n      input.click()\r\n    }\r\n\r\n    // 保存个人资料\r\n    const saveProfile = () => {\r\n      emit('update-profile', {\r\n        username: username.value,\r\n        avatar: currentAvatar.value,\r\n        bio: bio.value,\r\n        status: currentStatus.value\r\n      })\r\n      emit('close')\r\n    }\r\n\r\n    return {\r\n      username,\r\n      currentAvatar,\r\n      bio,\r\n      currentStatus,\r\n      statusOptions,\r\n      setStatus,\r\n      saveProfile,\r\n      openAvatarPicker,\r\n      getFallbackAvatarUrl,\r\n      handleAvatarError\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile-editor-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.profile-editor {\r\n  background: #2f3e33;\r\n  border-radius: 8px;\r\n  width: 100%;\r\n  max-width: 480px;\r\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\r\n  color: #ffffff;\r\n}\r\n\r\n.profile-header {\r\n  padding: 16px 20px;\r\n  background-color: #8a7158;\r\n  border-radius: 8px 8px 0 0;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.profile-header h2 {\r\n  margin: 0;\r\n  color: white;\r\n  font-size: 1.2rem;\r\n  font-weight: normal;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  color: white;\r\n  font-size: 1.5rem;\r\n  cursor: pointer;\r\n  padding: 4px;\r\n  opacity: 0.8;\r\n  transition: opacity 0.2s;\r\n}\r\n\r\n.close-btn:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.profile-content {\r\n  padding: 20px;\r\n}\r\n\r\n.avatar-section {\r\n  position: relative;\r\n  width: 120px;\r\n  height: 120px;\r\n  margin: 0 auto 24px;\r\n}\r\n\r\n.profile-avatar {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n  border: 4px solid rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.avatar-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  border-radius: 50%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  opacity: 0;\r\n  transition: opacity 0.2s;\r\n  cursor: pointer;\r\n}\r\n\r\n.avatar-overlay:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.change-text {\r\n  color: white;\r\n  font-size: 14px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 8px;\r\n  color: #ffffff;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  padding: 10px 12px;\r\n  background: rgba(0, 0, 0, 0.2);\r\n  border: none;\r\n  border-radius: 4px;\r\n  color: #ffffff;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.form-input::placeholder {\r\n  color: rgba(255, 255, 255, 0.5);\r\n}\r\n\r\n.bio-input {\r\n  min-height: 100px;\r\n  resize: vertical;\r\n}\r\n\r\n.status-options {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 10px;\r\n  margin-top: 8px;\r\n}\r\n\r\n.status-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 10px 12px;\r\n  background: rgba(0, 0, 0, 0.2);\r\n  border: none;\r\n  border-radius: 4px;\r\n  color: #ffffff;\r\n  cursor: pointer;\r\n  transition: background-color 0.2s;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.status-btn:hover {\r\n  background: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.status-btn.active {\r\n  background: #8a7158;\r\n}\r\n\r\n.status-dot {\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 50%;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.status-dot.online { background-color: #43b581; }\r\n.status-dot.away { background-color: #faa61a; }\r\n.status-dot.busy { background-color: #f04747; }\r\n.status-dot.invisible { background-color: #747f8d; }\r\n\r\n.profile-footer {\r\n  padding: 16px 20px;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 12px;\r\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.cancel-btn, .save-btn {\r\n  padding: 8px 16px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: normal;\r\n  font-size: 0.9rem;\r\n  border: none;\r\n  min-width: 80px;\r\n}\r\n\r\n.cancel-btn {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  color: #ffffff;\r\n}\r\n\r\n.save-btn {\r\n  background: #8a7158;\r\n  color: white;\r\n}\r\n\r\n.save-btn:hover {\r\n  background: #9a8168;\r\n}\r\n\r\n.cancel-btn:hover {\r\n  background: rgba(255, 255, 255, 0.15);\r\n}\r\n</style> "],"mappings":"AAkEA,SAASA,GAAG,EAAEC,QAAO,QAAS,KAAI;AAClC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,oBAAoB,EAAEC,iBAAgB,QAAS,yBAAwB;AAEhF,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,KAAK,EAAE;IACLC,MAAM,EAAEC,OAAO;IACfC,eAAe,EAAE;MACfC,IAAI,EAAEC,MAAM;MACZC,OAAO,EAAEA,CAAA,MAAO;QACdC,QAAQ,EAAE,EAAE;QACZC,MAAM,EAAE,EAAE;QACVC,GAAG,EAAE;MACP,CAAC;IACH;EACF,CAAC;EAEDC,KAAKA,CAACV,KAAK,EAAE;IAAEW;EAAK,CAAC,EAAE;IACrB,MAAMC,KAAI,GAAIhB,QAAQ,CAAC;IACvB,MAAMW,QAAO,GAAIb,GAAG,CAACM,KAAK,CAACG,eAAe,CAACI,QAAQ;IACnD,MAAMM,aAAY,GAAInB,GAAG,CAACM,KAAK,CAACG,eAAe,CAACK,MAAM;IACtD,MAAMC,GAAE,GAAIf,GAAG,CAACM,KAAK,CAACG,eAAe,CAACM,GAAG;;IAEzC;IACA,MAAMK,aAAY,GAAInB,QAAQ,CAAC,MAAMiB,KAAK,CAACG,OAAO,CAAC,0BAA0B,CAAC;IAC9E,MAAMC,aAAY,GAAIrB,QAAQ,CAAC,MAAMiB,KAAK,CAACK,KAAK,CAACC,UAAU,CAACC,SAAS;;IAErE;IACA,MAAMC,SAAQ,GAAI,MAAOC,MAAM,IAAK;MAClC,MAAMT,KAAK,CAACU,QAAQ,CAAC,sBAAsB,EAAED,MAAM;IACrD;;IAEA;IACA,MAAME,gBAAe,GAAIA,CAAA,KAAM;MAC7B,MAAMC,KAAI,GAAIC,QAAQ,CAACC,aAAa,CAAC,OAAO;MAC5CF,KAAK,CAACpB,IAAG,GAAI,MAAK;MAClBoB,KAAK,CAACG,MAAK,GAAI,SAAQ;MACvBH,KAAK,CAACI,QAAO,GAAKC,CAAC,IAAK;QACtB,MAAMC,IAAG,GAAID,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC;QAC7B,IAAIF,IAAI,EAAE;UACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC;UAC9BD,MAAM,CAACE,MAAK,GAAKN,CAAC,IAAK;YACrBhB,aAAa,CAACuB,KAAI,GAAIP,CAAC,CAACE,MAAM,CAACM,MAAK;UACtC;UACAJ,MAAM,CAACK,aAAa,CAACR,IAAI;QAC3B;MACF;MACAN,KAAK,CAACe,KAAK,CAAC;IACd;;IAEA;IACA,MAAMC,WAAU,GAAIA,CAAA,KAAM;MACxB7B,IAAI,CAAC,gBAAgB,EAAE;QACrBJ,QAAQ,EAAEA,QAAQ,CAAC6B,KAAK;QACxB5B,MAAM,EAAEK,aAAa,CAACuB,KAAK;QAC3B3B,GAAG,EAAEA,GAAG,CAAC2B,KAAK;QACdf,MAAM,EAAEP,aAAa,CAACsB;MACxB,CAAC;MACDzB,IAAI,CAAC,OAAO;IACd;IAEA,OAAO;MACLJ,QAAQ;MACRM,aAAa;MACbJ,GAAG;MACHK,aAAa;MACbE,aAAa;MACbI,SAAS;MACToB,WAAW;MACXjB,gBAAgB;MAChB1B,oBAAoB;MACpBC;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}