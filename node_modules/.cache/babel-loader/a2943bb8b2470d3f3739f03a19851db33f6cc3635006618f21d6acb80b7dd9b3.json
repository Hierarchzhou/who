{"ast":null,"code":"import { ref, watch } from 'vue';\nimport { getFallbackAvatarUrl } from '../../utils/avatarUtils';\nimport AvatarPicker from './AvatarPicker.vue';\nimport { useStore } from 'vuex';\nexport default {\n  name: 'UserProfileEditor',\n  components: {\n    AvatarPicker\n  },\n  props: {\n    isOpen: Boolean\n  },\n  setup(props, {\n    emit\n  }) {\n    const store = useStore();\n\n    // 从store获取用户信息\n    const username = ref(store.getters['userProfile/username'] || '');\n    const currentAvatar = ref(store.getters['userProfile/avatar'] || '');\n    const currentStatus = ref(store.getters['userProfile/status'] || 'online');\n    const bio = ref(store.getters['userProfile/bio'] || '');\n    const showAvatarPicker = ref(false);\n    const statusOptions = {\n      online: '在线',\n      away: '离开',\n      busy: '请勿打扰',\n      invisible: '隐身'\n    };\n\n    // 监听store中的用户信息变化\n    watch(() => store.getters['userProfile/profile'], newValue => {\n      username.value = newValue.username || '';\n      currentAvatar.value = newValue.avatar || '';\n      currentStatus.value = newValue.status || 'online';\n      bio.value = newValue.bio || '';\n    }, {\n      deep: true\n    });\n    const openAvatarPicker = () => showAvatarPicker.value = true;\n    const closeAvatarPicker = () => showAvatarPicker.value = false;\n    const handleAvatarSelected = avatar => currentAvatar.value = avatar;\n    const selectStatus = status => currentStatus.value = status;\n    const saveProfile = () => {\n      const updatedProfile = {\n        username: username.value,\n        avatar: currentAvatar.value,\n        status: currentStatus.value,\n        bio: bio.value\n      };\n\n      // 更新store中的用户信息\n      store.dispatch('userProfile/updateProfile', updatedProfile);\n      emit('update-profile', updatedProfile);\n      emit('close');\n    };\n    return {\n      username,\n      currentAvatar,\n      currentStatus,\n      bio,\n      statusOptions,\n      showAvatarPicker,\n      selectStatus,\n      saveProfile,\n      closeEditor: () => emit('close'),\n      openAvatarPicker,\n      closeAvatarPicker,\n      handleAvatarSelected,\n      getFallbackAvatarUrl\n    };\n  }\n};","map":{"version":3,"names":["ref","watch","getFallbackAvatarUrl","AvatarPicker","useStore","name","components","props","isOpen","Boolean","setup","emit","store","username","getters","currentAvatar","currentStatus","bio","showAvatarPicker","statusOptions","online","away","busy","invisible","newValue","value","avatar","status","deep","openAvatarPicker","closeAvatarPicker","handleAvatarSelected","selectStatus","saveProfile","updatedProfile","dispatch","closeEditor"],"sources":["C:\\Users\\Administrator\\Desktop\\who\\src\\components\\chat\\UserProfileEditor.vue"],"sourcesContent":["<template>\n  <div class=\"profile-editor-overlay\" v-if=\"isOpen\" @click.self=\"closeEditor\">\n    <div class=\"profile-editor-container\">\n      <!-- 头部 -->\n      <div class=\"profile-editor-header\">\n        <h2>个人资料</h2>\n        <button class=\"close-button\" @click=\"closeEditor\">\n          <span class=\"close-icon\">×</span>\n        </button>\n      </div>\n      \n      <!-- 主要内容区域 -->\n      <div class=\"profile-editor-content\">\n        <!-- 头像编辑区域 -->\n        <div class=\"avatar-section\">\n          <div class=\"current-avatar-wrapper\" @click=\"openAvatarPicker\">\n            <img :src=\"currentAvatar\" alt=\"用户头像\" class=\"current-avatar\" />\n            <div class=\"avatar-overlay\">\n              <span class=\"change-text\">更换头像</span>\n            </div>\n          </div>\n        </div>\n\n        <!-- 用户信息编辑区域 -->\n        <div class=\"user-info-section\">\n          <div class=\"form-group\">\n            <label for=\"username\">\n              用户名\n            </label>\n            <input \n              type=\"text\" \n              id=\"username\" \n              v-model=\"username\" \n              placeholder=\"设置你的用户名\"\n              class=\"form-input\"\n            />\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"status\">\n              状态\n            </label>\n            <div class=\"status-selector\">\n              <button \n                v-for=\"(status, key) in statusOptions\" \n                :key=\"key\"\n                class=\"status-option\"\n                :class=\"{ active: currentStatus === key }\"\n                @click=\"selectStatus(key)\"\n              >\n                <span class=\"status-icon\" :class=\"key\"></span>\n                <span class=\"status-text\">{{ status }}</span>\n              </button>\n            </div>\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"bio\">\n              个人简介\n            </label>\n            <textarea \n              id=\"bio\" \n              v-model=\"bio\" \n              placeholder=\"介绍一下自己吧...\"\n              class=\"form-input bio-input\"\n              rows=\"3\"\n            ></textarea>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 底部按钮 -->\n      <div class=\"profile-editor-footer\">\n        <button class=\"cancel-button\" @click=\"closeEditor\">\n          取消\n        </button>\n        <button class=\"save-button\" @click=\"saveProfile\">\n          确认更改\n        </button>\n      </div>\n    </div>\n\n    <!-- 头像选择器 -->\n    <AvatarPicker\n      v-if=\"showAvatarPicker\"\n      :currentAvatar=\"currentAvatar\"\n      @close=\"closeAvatarPicker\"\n      @select=\"handleAvatarSelected\"\n    />\n  </div>\n</template>\n\n<script>\nimport { ref, watch } from 'vue';\nimport { getFallbackAvatarUrl } from '../../utils/avatarUtils';\nimport AvatarPicker from './AvatarPicker.vue';\nimport { useStore } from 'vuex';\n\nexport default {\n  name: 'UserProfileEditor',\n  components: { AvatarPicker },\n  props: {\n    isOpen: Boolean\n  },\n  setup(props, { emit }) {\n    const store = useStore();\n    \n    // 从store获取用户信息\n    const username = ref(store.getters['userProfile/username'] || '');\n    const currentAvatar = ref(store.getters['userProfile/avatar'] || '');\n    const currentStatus = ref(store.getters['userProfile/status'] || 'online');\n    const bio = ref(store.getters['userProfile/bio'] || '');\n    const showAvatarPicker = ref(false);\n    \n    const statusOptions = {\n      online: '在线',\n      away: '离开',\n      busy: '请勿打扰',\n      invisible: '隐身'\n    };\n\n    // 监听store中的用户信息变化\n    watch(() => store.getters['userProfile/profile'], (newValue) => {\n      username.value = newValue.username || '';\n      currentAvatar.value = newValue.avatar || '';\n      currentStatus.value = newValue.status || 'online';\n      bio.value = newValue.bio || '';\n    }, { deep: true });\n\n    const openAvatarPicker = () => showAvatarPicker.value = true;\n    const closeAvatarPicker = () => showAvatarPicker.value = false;\n    const handleAvatarSelected = (avatar) => currentAvatar.value = avatar;\n    const selectStatus = (status) => currentStatus.value = status;\n\n    const saveProfile = () => {\n      const updatedProfile = {\n        username: username.value,\n        avatar: currentAvatar.value,\n        status: currentStatus.value,\n        bio: bio.value\n      };\n      \n      // 更新store中的用户信息\n      store.dispatch('userProfile/updateProfile', updatedProfile);\n      emit('update-profile', updatedProfile);\n      emit('close');\n    };\n\n    return {\n      username,\n      currentAvatar,\n      currentStatus,\n      bio,\n      statusOptions,\n      showAvatarPicker,\n      selectStatus,\n      saveProfile,\n      closeEditor: () => emit('close'),\n      openAvatarPicker,\n      closeAvatarPicker,\n      handleAvatarSelected,\n      getFallbackAvatarUrl\n    };\n  }\n}\n</script>\n\n<style scoped>\n.profile-editor-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n  backdrop-filter: blur(8px);\n}\n\n.profile-editor-container {\n  width: 90%;\n  max-width: 480px;\n  background: var(--chat-background);\n  border-radius: 16px;\n  overflow: hidden;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n  animation: slideIn 0.3s ease;\n}\n\n@keyframes slideIn {\n  from { transform: translateY(20px); opacity: 0; }\n  to { transform: translateY(0); opacity: 1; }\n}\n\n.profile-editor-header {\n  padding: 20px;\n  background: linear-gradient(to right, var(--primary-color), var(--secondary-color));\n  color: white;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.profile-editor-header h2 {\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 600;\n}\n\n.close-button {\n  background: none;\n  border: none;\n  color: white;\n  font-size: 24px;\n  cursor: pointer;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  transition: background-color 0.2s;\n}\n\n.close-button:hover { background-color: rgba(255, 255, 255, 0.2); }\n\n.profile-editor-content { padding: 24px; }\n\n.avatar-section {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 32px;\n}\n\n.current-avatar-wrapper {\n  position: relative;\n  width: 120px;\n  height: 120px;\n  border-radius: 50%;\n  overflow: hidden;\n  cursor: pointer;\n  background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));\n  padding: 3px;\n}\n\n.current-avatar {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: 50%;\n  background: var(--chat-background);\n}\n\n.avatar-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.current-avatar-wrapper:hover .avatar-overlay { opacity: 1; }\n\n.change-text {\n  color: white;\n  font-size: 14px;\n}\n\n.form-group {\n  margin-bottom: 24px;\n}\n\n.form-group label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n  color: var(--text-color);\n  font-weight: 500;\n}\n\n.form-group .material-icons {\n  font-size: 20px;\n  color: var(--primary-color);\n}\n\n.form-input {\n  width: 100%;\n  padding: 12px;\n  background: var(--input-background);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  color: var(--text-color);\n  font-size: 14px;\n  transition: all 0.2s;\n}\n\n.form-input:focus {\n  outline: none;\n  border-color: var(--primary-color);\n  box-shadow: 0 0 0 2px rgba(var(--primary-color-rgb), 0.2);\n}\n\n.bio-input {\n  resize: vertical;\n  min-height: 80px;\n}\n\n.status-selector {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));\n  gap: 8px;\n}\n\n.status-option {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background: var(--input-background);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.status-option:hover { background: var(--hover-color); }\n\n.status-option.active {\n  background: var(--primary-color);\n  color: white;\n  border-color: var(--primary-color);\n}\n\n.status-icon {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n}\n\n.status-icon.online { background-color: #43b581; }\n.status-icon.away { background-color: #faa61a; }\n.status-icon.busy { background-color: #f04747; }\n.status-icon.invisible { background-color: #747f8d; }\n\n.profile-editor-footer {\n  padding: 16px 20px;\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  background: var(--input-background);\n  border-top: 1px solid var(--border-color);\n}\n\n.cancel-button, .save-button {\n  padding: 8px 16px;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.cancel-button {\n  background: transparent;\n  border: 1px solid var(--border-color);\n  color: var(--text-color);\n}\n\n.cancel-button:hover { background: var(--hover-color); }\n\n.save-button {\n  background: var(--primary-color);\n  border: none;\n  color: white;\n}\n\n.save-button:hover {\n  background: var(--secondary-color);\n  transform: translateY(-1px);\n}\n\n.material-icons {\n  font-size: 18px;\n}\n\n@media (max-width: 480px) {\n  .profile-editor-container {\n    width: 100%;\n    height: 100%;\n    border-radius: 0;\n  }\n}\n</style> "],"mappings":"AA6FA,SAASA,GAAG,EAAEC,KAAI,QAAS,KAAK;AAChC,SAASC,oBAAmB,QAAS,yBAAyB;AAC9D,OAAOC,YAAW,MAAO,oBAAoB;AAC7C,SAASC,QAAO,QAAS,MAAM;AAE/B,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,UAAU,EAAE;IAAEH;EAAa,CAAC;EAC5BI,KAAK,EAAE;IACLC,MAAM,EAAEC;EACV,CAAC;EACDC,KAAKA,CAACH,KAAK,EAAE;IAAEI;EAAK,CAAC,EAAE;IACrB,MAAMC,KAAI,GAAIR,QAAQ,CAAC,CAAC;;IAExB;IACA,MAAMS,QAAO,GAAIb,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,sBAAsB,KAAK,EAAE,CAAC;IACjE,MAAMC,aAAY,GAAIf,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,oBAAoB,KAAK,EAAE,CAAC;IACpE,MAAME,aAAY,GAAIhB,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,oBAAoB,KAAK,QAAQ,CAAC;IAC1E,MAAMG,GAAE,GAAIjB,GAAG,CAACY,KAAK,CAACE,OAAO,CAAC,iBAAiB,KAAK,EAAE,CAAC;IACvD,MAAMI,gBAAe,GAAIlB,GAAG,CAAC,KAAK,CAAC;IAEnC,MAAMmB,aAAY,GAAI;MACpBC,MAAM,EAAE,IAAI;MACZC,IAAI,EAAE,IAAI;MACVC,IAAI,EAAE,MAAM;MACZC,SAAS,EAAE;IACb,CAAC;;IAED;IACAtB,KAAK,CAAC,MAAMW,KAAK,CAACE,OAAO,CAAC,qBAAqB,CAAC,EAAGU,QAAQ,IAAK;MAC9DX,QAAQ,CAACY,KAAI,GAAID,QAAQ,CAACX,QAAO,IAAK,EAAE;MACxCE,aAAa,CAACU,KAAI,GAAID,QAAQ,CAACE,MAAK,IAAK,EAAE;MAC3CV,aAAa,CAACS,KAAI,GAAID,QAAQ,CAACG,MAAK,IAAK,QAAQ;MACjDV,GAAG,CAACQ,KAAI,GAAID,QAAQ,CAACP,GAAE,IAAK,EAAE;IAChC,CAAC,EAAE;MAAEW,IAAI,EAAE;IAAK,CAAC,CAAC;IAElB,MAAMC,gBAAe,GAAIA,CAAA,KAAMX,gBAAgB,CAACO,KAAI,GAAI,IAAI;IAC5D,MAAMK,iBAAgB,GAAIA,CAAA,KAAMZ,gBAAgB,CAACO,KAAI,GAAI,KAAK;IAC9D,MAAMM,oBAAmB,GAAKL,MAAM,IAAKX,aAAa,CAACU,KAAI,GAAIC,MAAM;IACrE,MAAMM,YAAW,GAAKL,MAAM,IAAKX,aAAa,CAACS,KAAI,GAAIE,MAAM;IAE7D,MAAMM,WAAU,GAAIA,CAAA,KAAM;MACxB,MAAMC,cAAa,GAAI;QACrBrB,QAAQ,EAAEA,QAAQ,CAACY,KAAK;QACxBC,MAAM,EAAEX,aAAa,CAACU,KAAK;QAC3BE,MAAM,EAAEX,aAAa,CAACS,KAAK;QAC3BR,GAAG,EAAEA,GAAG,CAACQ;MACX,CAAC;;MAED;MACAb,KAAK,CAACuB,QAAQ,CAAC,2BAA2B,EAAED,cAAc,CAAC;MAC3DvB,IAAI,CAAC,gBAAgB,EAAEuB,cAAc,CAAC;MACtCvB,IAAI,CAAC,OAAO,CAAC;IACf,CAAC;IAED,OAAO;MACLE,QAAQ;MACRE,aAAa;MACbC,aAAa;MACbC,GAAG;MACHE,aAAa;MACbD,gBAAgB;MAChBc,YAAY;MACZC,WAAW;MACXG,WAAW,EAAEA,CAAA,KAAMzB,IAAI,CAAC,OAAO,CAAC;MAChCkB,gBAAgB;MAChBC,iBAAiB;MACjBC,oBAAoB;MACpB7B;IACF,CAAC;EACH;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}