{"ast":null,"code":"import { ref, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { getFallbackAvatarUrl, handleAvatarError } from '../../utils/avatarUtils';\nexport default {\n  name: 'UserProfileEditor',\n  props: {\n    isOpen: Boolean,\n    currentUserInfo: {\n      type: Object,\n      default: () => ({\n        username: '',\n        avatar: '',\n        bio: ''\n      })\n    }\n  },\n  setup(props, {\n    emit\n  }) {\n    const store = useStore();\n    const username = ref(props.currentUserInfo.username);\n    const currentAvatar = ref(props.currentUserInfo.avatar);\n    const bio = ref(props.currentUserInfo.bio);\n\n    // 从 store 获取状态相关数据\n    const currentStatus = computed(() => store.getters['userStatus/currentStatus']);\n    const statusOptions = computed(() => store.state.userStatus.statusMap);\n\n    // 设置用户状态\n    const setStatus = async status => {\n      await store.dispatch('userStatus/setStatus', status);\n    };\n\n    // 保存个人资料\n    const saveProfile = async () => {\n      // 更新用户状态\n      await store.dispatch('userStatus/setStatus', currentStatus.value);\n      emit('update-profile', {\n        username: username.value,\n        avatar: currentAvatar.value,\n        bio: bio.value,\n        status: currentStatus.value\n      });\n      emit('close');\n    };\n    return {\n      username,\n      currentAvatar,\n      bio,\n      currentStatus,\n      statusOptions,\n      setStatus,\n      saveProfile,\n      getFallbackAvatarUrl,\n      handleAvatarError\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","useStore","getFallbackAvatarUrl","handleAvatarError","name","props","isOpen","Boolean","currentUserInfo","type","Object","default","username","avatar","bio","setup","emit","store","currentAvatar","currentStatus","getters","statusOptions","state","userStatus","statusMap","setStatus","status","dispatch","saveProfile","value"],"sources":["C:\\Users\\Administrator\\Desktop\\discord-chat-app\\fack\\just-do-it\\src\\components\\profile\\UserProfileEditor.vue"],"sourcesContent":["<template>\n  <div class=\"profile-editor-overlay\" v-if=\"isOpen\">\n    <div class=\"profile-editor\">\n      <div class=\"profile-header\">\n        <h2>个人资料</h2>\n        <button class=\"close-btn\" @click=\"$emit('close')\">&times;</button>\n      </div>\n\n      <div class=\"profile-content\">\n        <!-- 头像部分 -->\n        <div class=\"avatar-section\">\n          <img :src=\"currentAvatar || getFallbackAvatarUrl()\" \n               alt=\"用户头像\" \n               class=\"profile-avatar\"\n               @error=\"handleAvatarError\" />\n          <div class=\"avatar-overlay\" @click=\"openAvatarPicker\">\n            <span class=\"change-text\">更换头像</span>\n          </div>\n        </div>\n\n        <!-- 用户名部分 -->\n        <div class=\"form-group\">\n          <label>用户名</label>\n          <input type=\"text\" \n                 v-model=\"username\" \n                 class=\"form-input\"\n                 placeholder=\"输入用户名\" />\n        </div>\n\n        <!-- 状态选择部分 -->\n        <div class=\"form-group\">\n          <label>状态</label>\n          <div class=\"status-options\">\n            <button \n              v-for=\"(text, status) in statusOptions\" \n              :key=\"status\"\n              class=\"status-btn\"\n              :class=\"{ active: status === currentStatus }\"\n              @click=\"setStatus(status)\"\n            >\n              <span class=\"status-dot\" :class=\"status\"></span>\n              <span class=\"status-text\">{{ text }}</span>\n            </button>\n          </div>\n        </div>\n\n        <!-- 个人简介部分 -->\n        <div class=\"form-group\">\n          <label>个人简介</label>\n          <textarea \n            v-model=\"bio\" \n            class=\"form-input bio-input\"\n            placeholder=\"介绍一下自己吧...\"\n          ></textarea>\n        </div>\n      </div>\n\n      <div class=\"profile-footer\">\n        <button class=\"cancel-btn\" @click=\"$emit('close')\">取消</button>\n        <button class=\"save-btn\" @click=\"saveProfile\">确认更改</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { getFallbackAvatarUrl, handleAvatarError } from '../../utils/avatarUtils'\n\nexport default {\n  name: 'UserProfileEditor',\n  props: {\n    isOpen: Boolean,\n    currentUserInfo: {\n      type: Object,\n      default: () => ({\n        username: '',\n        avatar: '',\n        bio: ''\n      })\n    }\n  },\n\n  setup(props, { emit }) {\n    const store = useStore()\n    const username = ref(props.currentUserInfo.username)\n    const currentAvatar = ref(props.currentUserInfo.avatar)\n    const bio = ref(props.currentUserInfo.bio)\n\n    // 从 store 获取状态相关数据\n    const currentStatus = computed(() => store.getters['userStatus/currentStatus'])\n    const statusOptions = computed(() => store.state.userStatus.statusMap)\n\n    // 设置用户状态\n    const setStatus = async (status) => {\n      await store.dispatch('userStatus/setStatus', status)\n    }\n\n    // 保存个人资料\n    const saveProfile = async () => {\n      // 更新用户状态\n      await store.dispatch('userStatus/setStatus', currentStatus.value)\n      \n      emit('update-profile', {\n        username: username.value,\n        avatar: currentAvatar.value,\n        bio: bio.value,\n        status: currentStatus.value\n      })\n      emit('close')\n    }\n\n    return {\n      username,\n      currentAvatar,\n      bio,\n      currentStatus,\n      statusOptions,\n      setStatus,\n      saveProfile,\n      getFallbackAvatarUrl,\n      handleAvatarError\n    }\n  }\n}\n</script>\n\n<style scoped>\n.profile-editor-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.profile-editor {\n  background: #2f3e33;\n  border-radius: 8px;\n  width: 100%;\n  max-width: 480px;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n  color: #ffffff;\n}\n\n.profile-header {\n  padding: 16px 20px;\n  background-color: #8a7158;\n  border-radius: 8px 8px 0 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.profile-header h2 {\n  margin: 0;\n  color: white;\n  font-size: 1.2rem;\n  font-weight: normal;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: white;\n  font-size: 1.5rem;\n  cursor: pointer;\n  padding: 4px;\n  opacity: 0.8;\n  transition: opacity 0.2s;\n}\n\n.close-btn:hover {\n  opacity: 1;\n}\n\n.profile-content {\n  padding: 20px;\n}\n\n.avatar-section {\n  position: relative;\n  width: 120px;\n  height: 120px;\n  margin: 0 auto 24px;\n}\n\n.profile-avatar {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 4px solid rgba(255, 255, 255, 0.1);\n}\n\n.avatar-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: 50%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transition: opacity 0.2s;\n  cursor: pointer;\n}\n\n.avatar-overlay:hover {\n  opacity: 1;\n}\n\n.change-text {\n  color: white;\n  font-size: 14px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  color: #ffffff;\n  font-size: 0.9rem;\n}\n\n.form-input {\n  width: 100%;\n  padding: 10px 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border: none;\n  border-radius: 4px;\n  color: #ffffff;\n  font-size: 0.9rem;\n}\n\n.form-input::placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.bio-input {\n  min-height: 100px;\n  resize: vertical;\n}\n\n.status-options {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 10px;\n}\n\n.status-btn {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border: none;\n  border-radius: 4px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n  width: 100%;\n}\n\n.status-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  transform: translateY(-1px);\n}\n\n.status-btn.active {\n  background: #8a7158;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.status-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  flex-shrink: 0;\n  transition: transform 0.2s ease;\n}\n\n.status-btn:hover .status-dot {\n  transform: scale(1.2);\n}\n\n.status-dot.online { background-color: #43b581; }\n.status-dot.away { background-color: #faa61a; }\n.status-dot.busy { background-color: #f04747; }\n.status-dot.invisible { background-color: #747f8d; }\n\n.profile-footer {\n  padding: 16px 20px;\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.cancel-btn, .save-btn {\n  padding: 8px 16px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: normal;\n  font-size: 0.9rem;\n  border: none;\n  min-width: 80px;\n}\n\n.cancel-btn {\n  background: rgba(255, 255, 255, 0.1);\n  color: #ffffff;\n}\n\n.save-btn {\n  background: #8a7158;\n  color: white;\n}\n\n.save-btn:hover {\n  background: #9a8168;\n}\n\n.cancel-btn:hover {\n  background: rgba(255, 255, 255, 0.15);\n}\n</style> "],"mappings":"AAkEA,SAASA,GAAG,EAAEC,QAAO,QAAS,KAAI;AAClC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,oBAAoB,EAAEC,iBAAgB,QAAS,yBAAwB;AAEhF,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,KAAK,EAAE;IACLC,MAAM,EAAEC,OAAO;IACfC,eAAe,EAAE;MACfC,IAAI,EAAEC,MAAM;MACZC,OAAO,EAAEA,CAAA,MAAO;QACdC,QAAQ,EAAE,EAAE;QACZC,MAAM,EAAE,EAAE;QACVC,GAAG,EAAE;MACP,CAAC;IACH;EACF,CAAC;EAEDC,KAAKA,CAACV,KAAK,EAAE;IAAEW;EAAK,CAAC,EAAE;IACrB,MAAMC,KAAI,GAAIhB,QAAQ,CAAC;IACvB,MAAMW,QAAO,GAAIb,GAAG,CAACM,KAAK,CAACG,eAAe,CAACI,QAAQ;IACnD,MAAMM,aAAY,GAAInB,GAAG,CAACM,KAAK,CAACG,eAAe,CAACK,MAAM;IACtD,MAAMC,GAAE,GAAIf,GAAG,CAACM,KAAK,CAACG,eAAe,CAACM,GAAG;;IAEzC;IACA,MAAMK,aAAY,GAAInB,QAAQ,CAAC,MAAMiB,KAAK,CAACG,OAAO,CAAC,0BAA0B,CAAC;IAC9E,MAAMC,aAAY,GAAIrB,QAAQ,CAAC,MAAMiB,KAAK,CAACK,KAAK,CAACC,UAAU,CAACC,SAAS;;IAErE;IACA,MAAMC,SAAQ,GAAI,MAAOC,MAAM,IAAK;MAClC,MAAMT,KAAK,CAACU,QAAQ,CAAC,sBAAsB,EAAED,MAAM;IACrD;;IAEA;IACA,MAAME,WAAU,GAAI,MAAAA,CAAA,KAAY;MAC9B;MACA,MAAMX,KAAK,CAACU,QAAQ,CAAC,sBAAsB,EAAER,aAAa,CAACU,KAAK;MAEhEb,IAAI,CAAC,gBAAgB,EAAE;QACrBJ,QAAQ,EAAEA,QAAQ,CAACiB,KAAK;QACxBhB,MAAM,EAAEK,aAAa,CAACW,KAAK;QAC3Bf,GAAG,EAAEA,GAAG,CAACe,KAAK;QACdH,MAAM,EAAEP,aAAa,CAACU;MACxB,CAAC;MACDb,IAAI,CAAC,OAAO;IACd;IAEA,OAAO;MACLJ,QAAQ;MACRM,aAAa;MACbJ,GAAG;MACHK,aAAa;MACbE,aAAa;MACbI,SAAS;MACTG,WAAW;MACX1B,oBAAoB;MACpBC;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}