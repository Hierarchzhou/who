webpackJsonp([1],[function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var s=a(8),n=i(s),h=a(6),r=i(h),o=a(7),c=i(o);new n.default({el:"#app",components:{VueAvatar:r.default,VueAvatarScale:c.default},methods:{onChangeScale:function(t){this.$refs.vueavatar.changeScale(t)},saveClicked:function(){console.log("save clicked");var t=this.$refs.vueavatar.getImageScaled();document.getElementById("img-1").src=t.toDataURL()},onImageReady:function(t){this.$refs.vueavatarscale.setScale(t)}}})},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(t,e,a,i,s,n){if(0===n)t.rect(e,a,i,s);else{var h=i-n,r=s-n;t.translate(e,a),t.arc(n,n,n,Math.PI,1.5*Math.PI),t.lineTo(h,0),t.arc(h,n,n,1.5*Math.PI,2*Math.PI),t.lineTo(i,r),t.arc(h,r,n,2*Math.PI,.5*Math.PI),t.lineTo(n,s),t.arc(n,r,n,.5*Math.PI,Math.PI),t.translate(-e,-a)}};e.default={props:{image:{type:String,default:""},border:{type:Number,default:25},borderRadius:{type:Number,default:0},width:{type:Number,default:200},height:{type:Number,default:200},color:{type:Array,default:function(){return[0,0,0,.5]}}},data:function(){return{cursor:"cursorPointer",scale:1,canvas:null,context:null,dragged:!1,imageLoaded:!1,state:{drag:!1,my:null,mx:null,xxx:"ab",image:{x:0,y:0,resource:null}}}},computed:{canvasWidth:function(){return this.getDimensions().canvas.width},canvasHeight:function(){return this.getDimensions().canvas.height}},mounted:function(){if(this.canvas=this.$refs.canvas,this.context=this.canvas.getContext("2d"),this.paint(),this.image)this.loadImage(this.image);else{var t=this.svgToImage(this.context,'<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 65"><defs><style>.cls-1{fill:#999;}</style></defs><title>Upload_Upload</title><path class="cls-1" d="M32.5,1A31.5,31.5,0,1,1,1,32.5,31.54,31.54,0,0,1,32.5,1m0-1A32.5,32.5,0,1,0,65,32.5,32.5,32.5,0,0,0,32.5,0h0Z"/><polygon class="cls-1" points="41.91 28.2 32.59 18.65 23.09 28.39 24.17 29.44 31.87 21.54 31.87 40.05 33.37 40.05 33.37 21.59 40.83 29.25 41.91 28.2"/><polygon class="cls-1" points="40.66 40.35 40.66 44.35 24.34 44.35 24.34 40.35 22.34 40.35 22.34 44.35 22.34 46.35 24.34 46.35 40.66 46.35 42.66 46.35 42.66 44.35 42.66 40.35 40.66 40.35"/></svg>'),e=this;t.onload=function(){var a=(e.getDimensions(),e.canvasWidth/2-this.width/2),i=e.canvasHeight/2-this.height/2;e.context.drawImage(t,a,i,this.width,this.height)}}},methods:{svgToImage:function(t,e){var a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),i=self.URL||self.webkitURL||self,s=i.createObjectURL(a),n=new Image;return n.src=s,n},setState:function(t){var e=Math.ceil(1),a=Math.floor(1e4);this.state=t,this.state.cnt="HELLO"+Math.floor(Math.random()*(a-e))+e},paint:function(){this.context.save(),this.context.translate(0,0),this.context.fillStyle="rgba("+this.color.slice(0,4).join(",")+")";var t=this.borderRadius,e=this.getDimensions(),i=e.border,s=e.canvas.height,n=e.canvas.width;t=Math.max(t,0),t=Math.min(t,n/2-i,s/2-i),this.context.beginPath(),a(this.context,i,i,n-2*i,s-2*i,t),this.context.rect(n,0,-n,s),this.context.fill("evenodd"),this.context.restore()},getDimensions:function(){return{width:this.width,height:this.height,border:this.border,canvas:{width:this.width+2*this.border,height:this.height+2*this.border}}},onDrop:function(t){var e=this;if(t=t||window.event,t.stopPropagation(),t.preventDefault(),t.dataTransfer&&t.dataTransfer.files.length){var a=new FileReader,i=t.dataTransfer.files[0];a.onload=function(t){return e.loadImage(t.target.result)},a.readAsDataURL(i)}},onDragStart:function(t){t=t||window.event,t.preventDefault(),this.state.drag=!0,this.state.mx=null,this.state.my=null,this.cursor="cursorGrabbing"},onDragEnd:function(t){this.state.drag&&(this.state.drag=!1,this.cursor="cursorPointer")},onMouseMove:function(t){if(t=t||window.event,this.state.drag!==!1){this.dragged=!0;var e=this.state.image,a=e.x,i=e.y,s=t.targetTouches?t.targetTouches[0].pageX:t.clientX,n=t.targetTouches?t.targetTouches[0].pageY:t.clientY,h={mx:s,my:n,image:e};if(this.state.mx&&this.state.my){var r=(this.state.mx-s)/this.scale,o=(this.state.my-n)/this.scale;e.y=this.getBoundedY(i-o,this.scale),e.x=this.getBoundedX(a-r,this.scale)}this.state.mx=h.mx,this.state.my=h.my,this.state.image=e}},loadImage:function(t){var e=new Image,a=this;e.onload=function(){a.handleImageReady(e)},this.isDataURL(t)||(e.crossOrigin="anonymous"),e.src=t},handleImageReady:function(t){var e=this.getInitialSize(t.width,t.height);e.resource=t,e.x=0,e.y=0;var a=this.state;a.drag=!1,a.image=e,this.state.image.x=0,this.state.image.y=0,this.state.image.resource=t,this.state.image.width=e.width,this.state.image.height=e.height,this.state.drag=!1,this.scale=1,this.$emit("vue-avatar-editor:image-ready",this.scale),this.imageLoaded=!0,this.cursor="cursorGrab"},getInitialSize:function(t,e){var a=void 0,i=void 0,s=this.getDimensions(),n=s.height/s.width,h=e/t;return n>h?(a=this.getDimensions().height,i=t*(a/e)):(i=this.getDimensions().width,a=e*(i/t)),{height:a,width:i}},isDataURL:function(t){if(null===t)return!1;var e=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+=[a-z\-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@\/?%\s]*\s*$/i;return!!t.match(e)},getBoundedX:function(t,e){var a=this.state.image,i=this.getDimensions(),s=Math.floor((a.width-i.width/e)/2);return s=Math.max(0,s),Math.max(-s,Math.min(t,s))},getBoundedY:function(t,e){var a=this.state.image,i=this.getDimensions(),s=Math.floor((a.height-i.height/e)/2);return s=Math.max(0,s),Math.max(-s,Math.min(t,s))},paintImage:function(t,e,a){if(e.resource){var i=this.calculatePosition(e,a);t.save(),t.globalCompositeOperation="destination-over",t.drawImage(e.resource,i.x,i.y,i.width,i.height),t.restore()}},calculatePosition:function(t,e){var t=t||this.state.image,a=this.getDimensions(),i=t.width*this.scale,s=t.height*this.scale,n=(i-a.width)/2,h=(s-a.height)/2,r=t.x*this.scale-n+e,o=t.y*this.scale-h+e;return{x:r,y:o,height:s,width:i}},changeScale:function(t){this.scale=t},redraw:function(){this.context.clearRect(0,0,this.getDimensions().canvas.width,this.getDimensions().canvas.height),this.paint(),this.paintImage(this.context,this.state.image,this.border)},getImage:function(){var t=this.getCroppingRect(),e=this.state.image;t.x*=e.resource.width,t.y*=e.resource.height,t.width*=e.resource.width,t.height*=e.resource.height;var a=document.createElement("canvas");return a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(e.resource,-t.x,-t.y),a},getImageScaled:function(){var t=this.getDimensions(),e=t.width,a=t.height,i=document.createElement("canvas");return i.width=e,i.height=a,this.paintImage(i.getContext("2d"),this.state.image,0),i},getCroppingRect:function(){var t=this.getDimensions(),e={x:t.border,y:t.border,width:t.width,height:t.height},a=this.calculatePosition(this.state.image,t.border);return{x:(e.x-a.x)/a.width,y:(e.y-a.y)/a.height,width:e.width/a.width,height:e.height/a.height}},clicked:function(t){1==this.dragged?this.dragged=!1:document.getElementById("ab-1").click()},fileSelected:function(t){var e=this,a=t.target.files||t.dataTransfer.files;if(a.length){var i=(new Image,new FileReader);i.onload=function(t){e.loadImage(t.target.result)},i.readAsDataURL(a[0])}}},watch:{state:{handler:function(t,e){1==this.imageLoaded&&this.redraw()},deep:!0},scale:function(){1==this.imageLoaded&&this.redraw()}}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{width:{type:Number,default:200},min:{type:Number,default:1},max:{type:Number,default:2},step:{type:Number,default:.01}},methods:{setScale:function(t){this.scale=t}},data:function(){return{scale:1}},watch:{scale:function(){this.$emit("vue-avatar-editor-scale:change-scale",this.scale)}}}},function(t,e){},function(t,e){t.exports=" <canvas :width=canvasWidth :height=canvasHeight ref=canvas @dragover.prevent @drop=onDrop @mousedown=onDragStart @mouseup=onDragEnd @mousemove=onMouseMove @click=clicked v-bind:class=cursor> <input type=file id=ab-1 @change=fileSelected style=display:none> </canvas>"},function(t,e){t.exports=" <input v-model=scale type=range :min=min :max=max :step=step :style=\"{ width:width +'px'}\"/> "},function(t,e,a){var i,s;a(3),i=a(1),s=a(4),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),s&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=s)},function(t,e,a){var i,s;i=a(2),s=a(5),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),s&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=s)}]);
//# sourceMappingURL=app.0fe1fa6985d865347d09.js.map